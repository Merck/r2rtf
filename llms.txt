# r2rtf

## Overview

r2rtf is an R package to create production-ready tables and figures in
RTF format. The package is designed with these principles:

- Provide simple “verb” functions that correspond to each component of a
  table, to help you translate data frame(s) to a table in RTF file.
- Functions are chainable with pipes (`%>%`).
- Only focus on **table format**.
  - Data manipulation and analysis should be handled by other R
    packages, for example, tidyverse.
- Minimize package dependency.

The [R for clinical study reports and submission](https://r4csr.org/)
book provides tutorials by using real world examples.

## Installation

You can install the package via CRAN:

``` r
install.packages("r2rtf")
```

Or, install from GitHub:

``` r
remotes::install_github("Merck/r2rtf")
```

## Highlighted features

The R package r2rtf provides flexibility to enable features below:

- Create highly customized RTF tables and figures ready for production.
- Simple to use parameters and data structure.
  - Customized column header: split by `"|"`.
  - Three required parameters for the output tables (data, filename,
    column relative width).
  - Flexible and detail control of table structure.
- Format control in cell, row, column and table level for:
  - Border Type: single, double, dash, dot, etc.
  - Alignment: left, right, center, decimal.
  - Column width.
  - Text appearance: **bold**, *italics*, ~~strikethrough~~, underline
    and any combinations.
  - Font size.
  - Text and border color (657 different colors named in `color()`
    function).
  - Special characters: any character in UTF-8 encoding (e.g., Greek,
    Symbol, Chinese, Japanese, Korean).
- Append several tables into one file.
- Pagination.
- Built-in raw data for validation.

## Simple example

``` r
library(dplyr)
library(r2rtf)

head(iris) %>%
  rtf_body() %>% # Step 1 Add attributes
  rtf_encode() %>% # Step 2 Convert attributes to RTF encode
  write_rtf(file = "ex-tbl.rtf") # Step 3 Write to a .rtf file
```

Click here to see the output

![](https://merck.github.io/r2rtf/articles/fig/ex-tbl.png)

- [More Examples](https://merck.github.io/r2rtf/articles/index.html)

## Example efficacy table

- [Source
  code](https://merck.github.io/r2rtf/articles/example-efficacy.html)

Click here to see the output

![](https://merck.github.io/r2rtf/articles/fig/efficacy_example.png)

## Example safety table

- [Source
  code](https://merck.github.io/r2rtf/articles/example-ae-summary.html)

Click here to see the output

![](https://merck.github.io/r2rtf/articles/fig/ae_example.png)

## Citation

If you use this software, please cite it as below.

> Wang, S., Ye, S., Anderson, K., & Zhang, Y. (2020). r2rtf—an R Package
> to Produce Rich Text Format (RTF) Tables and Figures. *PharmaSUG*.
> <https://pharmasug.org/proceedings/2020/DV/PharmaSUG-2020-DV-198.pdf>

A BibTeX entry for LaTeX users is

``` bibtex
@inproceedings{wang2020r2rtf,
  title     = {{r2rtf}---an {R} Package to Produce {Rich Text Format} ({RTF}) Tables and Figures},
  author    = {Wang, Siruo and Ye, Simiao and Anderson, Keaven M and Zhang, Yilong},
  booktitle = {PharmaSUG},
  year      = {2020},
  url       = {https://pharmasug.org/proceedings/2020/DV/PharmaSUG-2020-DV-198.pdf}
}
```

# Package index

## RTF Table

- [`rtf_page()`](https://merck.github.io/r2rtf/reference/rtf_page.md) :
  Add RTF File Page Information
- [`rtf_page_header()`](https://merck.github.io/r2rtf/reference/rtf_page_header.md)
  : Add RTF Page Header Information
- [`rtf_page_footer()`](https://merck.github.io/r2rtf/reference/rtf_page_footer.md)
  : Add RTF Page Footer Information
- [`rtf_title()`](https://merck.github.io/r2rtf/reference/rtf_title.md)
  : Add Title Attributes to Table
- [`rtf_subline()`](https://merck.github.io/r2rtf/reference/rtf_subline.md)
  : Add Subline Attributes to Table
- [`rtf_colheader()`](https://merck.github.io/r2rtf/reference/rtf_colheader.md)
  : Add Column Header Attributes to Table
- [`rtf_body()`](https://merck.github.io/r2rtf/reference/rtf_body.md) :
  Add Table Body Attributes to the Table
- [`rtf_footnote()`](https://merck.github.io/r2rtf/reference/rtf_footnote.md)
  : Add Footnote Attributes to Table
- [`rtf_source()`](https://merck.github.io/r2rtf/reference/rtf_source.md)
  : Add Data Source Attributes to the Table
- [`rtf_encode()`](https://merck.github.io/r2rtf/reference/rtf_encode.md)
  : Render to RTF Encoding
- [`write_rtf()`](https://merck.github.io/r2rtf/reference/write_rtf.md)
  : Write an RTF Table or Figure to an RTF File
- [`assemble_rtf()`](https://merck.github.io/r2rtf/reference/assemble_rtf.md)
  : Assemble Multiple RTF Table Listing and Figure Into One RTF Document
- [`assemble_docx()`](https://merck.github.io/r2rtf/reference/assemble_docx.md)
  : Assemble Multiple RTF Table Listing and Figure Into One Word
  Document

## RTF Figure

- [`rtf_read_figure()`](https://merck.github.io/r2rtf/reference/rtf_read_figure.md)
  : Read Figures into Binary Files
- [`rtf_figure()`](https://merck.github.io/r2rtf/reference/rtf_figure.md)
  : Add Figure Attributes

## Example Data

- [`r2rtf_HAMD17`](https://merck.github.io/r2rtf/reference/r2rtf_HAMD17.md)
  : An Efficacy Clinical Trial Data to Evaluate a Drug to Reduce Lower
  Back Pain
- [`r2rtf_adsl`](https://merck.github.io/r2rtf/reference/r2rtf_adsl.md)
  : A Subject Level Demographic Dataset
- [`r2rtf_adae`](https://merck.github.io/r2rtf/reference/r2rtf_adae.md)
  : An Adverse Event Dataset
- [`r2rtf_tbl1`](https://merck.github.io/r2rtf/reference/r2rtf_tbl1.md)
  : Within Group Results from an ANCOVA Model
- [`r2rtf_tbl2`](https://merck.github.io/r2rtf/reference/r2rtf_tbl2.md)
  : Between Group Results from an ANCOVA Model
- [`r2rtf_tbl3`](https://merck.github.io/r2rtf/reference/r2rtf_tbl3.md)
  : Root Mean Square Error from an ANCOVA model

## Utility

- [`rtf_rich_text()`](https://merck.github.io/r2rtf/reference/rtf_rich_text.md)
  : Text to Formatted RTF Encode
- [`rtf_read_png()`](https://merck.github.io/r2rtf/reference/rtf_read_png.md)
  : Read PNG Figures into Binary Files
- [`utf8Tortf()`](https://merck.github.io/r2rtf/reference/utf8Tortf.md)
  : Convert a UTF-8 Encoded Character String to a RTF Encoded String

# Articles

### Get Started

- [Introduction to
  r2rtf](https://merck.github.io/r2rtf/articles/r2rtf.md):

  Start here if this is your first time using r2rtf. You’ll learn the
  basic philosophy, the most important rtf table generation verbs.

### TLF Examples

- [RTF Examples for Baseline Characteristics
  Tables](https://merck.github.io/r2rtf/articles/example-basechar.md):
- [RTF Examples for Efficacy
  Tables](https://merck.github.io/r2rtf/articles/example-efficacy.md):
- [RTF Examples for AE Summary Count
  Tables](https://merck.github.io/r2rtf/articles/example-ae-summary.md):
- [RTF Examples for
  Figures](https://merck.github.io/r2rtf/articles/example-figure.md):
- [RTF Examples for Tables with Sublineby, Pageby, and Groupby
  Features](https://merck.github.io/r2rtf/articles/example-sublineby-pageby-groupby.md):

### Paragraph Style

- [RTF Examples for Controlling Text and Paragraph
  Details](https://merck.github.io/r2rtf/articles/rtf-text.md):
- [RTF Examples for Controlling Table
  Details](https://merck.github.io/r2rtf/articles/rtf-row.md):

### Utility

- [File Format
  Conversion](https://merck.github.io/r2rtf/articles/rtf-convert-format.md):

### Package Design

- [r2rtf Design
  Pattern](https://merck.github.io/r2rtf/articles/design-pattern.md):

### CRAN

- [An Introduction to the r2rtf
  Package](https://merck.github.io/r2rtf/articles/r2rtf-cran.md):
