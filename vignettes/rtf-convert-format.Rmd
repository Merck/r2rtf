---
title: "File Format Conversion"
output:
  html_document:
    df_print: paged
    toc: yes
    toc_depth: '2'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, collapse = TRUE)
library(r2rtf)
```

```{r, include = FALSE, eval = FALSE}
r2rtf:::rtf_convert_format(
  input = list.files("vignettes/rtf/", pattern = "*.rtf", full.names = TRUE),
  output_dir = "vignettes/html",
  format = "html"
)
```

## Overview

`r2rtf` provides multiple ways to convert RTF format to other formats including PDF, DOCX, and HTML:

1. **User-facing functions**: `write_docx()` and `write_html()` - Exported functions for converting RTF encoding to DOCX or HTML
2. **Internal function**: `r2rtf:::rtf_convert_format()` - Lower-level function for batch conversion of RTF files

All conversion features require LibreOffice >= 7.1 and currently support Unix/Linux/macOS systems only.

## Using write_docx() and write_html()

The `write_docx()` and `write_html()` functions provide a simple interface to convert RTF encoding directly to DOCX or HTML formats.

### Write DOCX

```{r, eval = FALSE}
# Create RTF encoding
rtf <- head(iris) |>
  rtf_body() |>
  rtf_encode()

# Convert to DOCX
write_docx(rtf, "output/table.docx")
```

### Write HTML

```{r, eval = FALSE}
# Create RTF encoding
rtf <- head(cars) |>
  rtf_body() |>
  rtf_encode()

# Convert to HTML
write_html(rtf, "output/table.html")
```
## Using rtf_convert_format() (Advanced)

The internal `r2rtf:::rtf_convert_format()` function provides more control for batch processing of existing RTF files.

By default, `r2rtf:::rtf_convert_format` converts RTF files to PDF format.
The PDF file will be saved in the same folder with same file name by default.

In the example below, `ae_example.pdf` will be created in the same folder. 

```{r, eval = FALSE}
r2rtf:::rtf_convert_format(input = "rtf/ae_example.rtf")
```

- Multiple files can be provided as input.

```{r, eval = FALSE}
r2rtf:::rtf_convert_format(input = list.files("rtf", pattern = "*.rtf"))
```

- The `format` argument allows you to specify output format as `pdf`, `docx`, or `html`. 

```{r, eval = FALSE}
r2rtf:::rtf_convert_format(input = "rtf/ae_example.rtf", format = "html")
```

### Limitations 

There is one known limitation after RTF file convert to HTML files:   

- table border issue.
  - "dash", "small dash", "dot dash", and "dot dot" border type are not supported 

```{r, out.width = "100%", out.height = "400px", echo = FALSE, fig.align = "center"}
knitr::include_graphics("pdf/border-type.pdf")
```

````{=html}
```{r, echo=FALSE, results='asis'}
xfun::file_string("html/border-type.html")
```
````
