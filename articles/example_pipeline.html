<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RTF Examples for Tables • r2rtf</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="RTF Examples for Tables">
<meta property="og:description" content="r2rtf">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">r2rtf</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Initial Version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example-figure.html">RTF Examples for Figures</a>
    </li>
    <li>
      <a href="../articles/example_pipeline.html">RTF Examples for Tables</a>
    </li>
    <li>
      <a href="../articles/rtf-row.html">RTF Examples for Controling Table Details</a>
    </li>
    <li>
      <a href="../articles/rtf-text.html">RTF Examples for Controling Text and Paragraph Details</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>RTF Examples for Tables</h1>
            
      
      
      <div class="hidden name"><code>example_pipeline.Rmd</code></div>

    </div>

    
    
<p>Define some utility functions</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co">#' Format Model Estimator</span>
<span class="co">#'</span>
<span class="co">#' The function assume 1 or 2 column.</span>
<span class="co">#'   If there is only 1 column, only represent mean</span>
<span class="co">#'   If there are 2 column, represent mean (sd) or mean(se)</span>
<span class="co">#' Decimals will understand the number will be formated as x.x(x.xx)</span>
<span class="co">#' @noRd</span>
<span class="no">fmt_est</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">data</span>, <span class="no">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"mean"</span>, <span class="st">"sd"</span>), <span class="no">decimals</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>)){
  <span class="no">.mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span>(<span class="no">data</span><span class="kw">[[</span><span class="no">columns</span><span class="kw">[[</span><span class="fl">1</span>]]]], <span class="kw">digits</span> <span class="kw">=</span> <span class="no">decimals</span>[<span class="fl">1</span>], <span class="kw">format</span> <span class="kw">=</span> <span class="st">"f"</span>, <span class="kw">flag</span> <span class="kw">=</span> <span class="st">"0"</span>)
  <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">columns</span>) <span class="kw">&gt;</span> <span class="fl">1</span>){
    <span class="no">.sd</span>   <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span>(<span class="no">data</span><span class="kw">[[</span><span class="no">columns</span><span class="kw">[[</span><span class="fl">2</span>]]]], <span class="kw">digits</span> <span class="kw">=</span> <span class="no">decimals</span>[<span class="fl">2</span>], <span class="kw">format</span> <span class="kw">=</span> <span class="st">"f"</span>, <span class="kw">flag</span> <span class="kw">=</span> <span class="st">"0"</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">.mean</span>, <span class="st">" ("</span>, <span class="no">.sd</span>, <span class="st">")"</span>)
  }<span class="kw">else</span>{
    <span class="no">.mean</span>
  }

}

<span class="co">#' Format Confidence Interval</span>
<span class="co">#' @noRd</span>
<span class="no">fmt_ci</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">data</span>, <span class="no">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"lower.CL"</span>, <span class="st">"upper.CL"</span>), <span class="no">decimals</span> <span class="kw">=</span> <span class="fl">2</span>){
  <span class="no">.lower</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span>(<span class="no">data</span><span class="kw">[[</span><span class="no">columns</span><span class="kw">[[</span><span class="fl">1</span>]]]], <span class="kw">digits</span> <span class="kw">=</span> <span class="no">decimals</span>, <span class="kw">format</span> <span class="kw">=</span> <span class="st">"f"</span>, <span class="kw">flag</span> <span class="kw">=</span> <span class="st">"0"</span>)
  <span class="no">.upper</span>   <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span>(<span class="no">data</span><span class="kw">[[</span><span class="no">columns</span><span class="kw">[[</span><span class="fl">2</span>]]]], <span class="kw">digits</span> <span class="kw">=</span> <span class="no">decimals</span>, <span class="kw">format</span> <span class="kw">=</span> <span class="st">"f"</span>, <span class="kw">flag</span> <span class="kw">=</span> <span class="st">"0"</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="no">.lower</span>, <span class="st">", "</span> , <span class="no">.upper</span>, <span class="st">")"</span>)
}

<span class="co">#' Format P-Value</span>
<span class="co">#' @noRd</span>
<span class="no">fmt_pval</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">data</span>, <span class="no">columns</span> <span class="kw">=</span> <span class="st">"p.value"</span>, <span class="no">decimals</span> <span class="kw">=</span> <span class="fl">3</span>){
  <span class="no">scale</span> <span class="kw">&lt;-</span> <span class="fl">10</span> ^ (-<span class="fl">1</span> * <span class="no">decimals</span>)
  <span class="no">p_scale</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"&lt;"</span>,<span class="no">scale</span>)
  <span class="fu">if_else</span>(<span class="no">data</span><span class="kw">[[</span><span class="no">columns</span><span class="kw">[[</span><span class="fl">1</span>]]]] <span class="kw">&lt;</span>  <span class="no">scale</span>, <span class="no">p_scale</span>,
          <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span>(<span class="no">data</span><span class="kw">[[</span><span class="no">columns</span><span class="kw">[[</span><span class="fl">1</span>]]]], <span class="kw">digits</span> <span class="kw">=</span> <span class="no">decimals</span>, <span class="kw">format</span> <span class="kw">=</span> <span class="st">"f"</span>, <span class="kw">flag</span> <span class="kw">=</span> <span class="st">"0"</span>) )
}</pre></body></html></div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<div id="example-1-ancova-analysis-for-homa-data" class="section level2">
<h2 class="hasAnchor">
<a href="#example-1-ancova-analysis-for-homa-data" class="anchor"></a>Example 1: ANCOVA analysis for HOMA data</h2>
<ul>
<li><p>The data is avaliable at <a href="https://missingdata.lshtm.ac.uk/dia-working-group/example-data-sets/">https://missingdata.lshtm.ac.uk/dia-working-group/example-data-sets/</a></p></li>
<li><p>For example, we want to summary the analysis results using ANCOVA model</p></li>
</ul>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"HAMD17"</span>)
<span class="no">ana_week</span> <span class="kw">=</span> <span class="fl">8</span>   <span class="co"># Analysis Week </span>

<span class="no">HAMD17_lmfit</span> <span class="kw">&lt;-</span> <span class="no">HAMD17</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">week</span> <span class="kw">==</span> <span class="no">ana_week</span>) <span class="kw">%&gt;%</span>
                       <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">change</span> ~ <span class="no">basval</span> + <span class="no">TRT</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">.</span>)</pre></body></html></div>
<div id="raw-summary" class="section level3">
<h3 class="hasAnchor">
<a href="#raw-summary" class="anchor"></a>Raw summary</h3>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">t11</span> <span class="kw">&lt;-</span> <span class="no">HAMD17</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">week</span> <span class="kw">==</span> <span class="no">ana_week</span>) <span class="kw">%&gt;%</span>
         <span class="fu">group_by</span>(<span class="no">TRT</span>) <span class="kw">%&gt;%</span>
         <span class="fu">summarise</span>( <span class="kw">N</span> <span class="kw">=</span> <span class="fu">n</span>(),
                    <span class="kw">mean_bl</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">basval</span>),
                    <span class="kw">sd_bl</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">basval</span>),
                    <span class="kw">mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">change</span>),
                    <span class="kw">sd</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">change</span>))</pre></body></html></div>
</div>
<div id="ls-mean" class="section level3">
<h3 class="hasAnchor">
<a href="#ls-mean" class="anchor"></a>LS mean</h3>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">t12</span> <span class="kw">&lt;-</span> <span class="fu">emmeans</span>(<span class="no">HAMD17_lmfit</span>, <span class="st">"TRT"</span>)
<span class="no">t1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(<span class="no">t11</span>, <span class="no">t12</span>) <span class="kw">%&gt;%</span>
      <span class="fu">mutate</span>(<span class="kw">emmean_sd</span> <span class="kw">=</span> <span class="no">SE</span> * <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="no">df</span>)) <span class="kw">%&gt;%</span>
      <span class="fu">mutate</span>( <span class="kw">Trt</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Study Drug"</span>, <span class="st">"Placebo"</span>),
              <span class="kw">N1</span> <span class="kw">=</span> <span class="no">N</span>,
              <span class="kw">Mean1</span> <span class="kw">=</span> <span class="fu">fmt_est</span>(<span class="no">.</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"mean_bl"</span>, <span class="st">"sd_bl"</span>) ),
              <span class="kw">N2</span> <span class="kw">=</span> <span class="no">N</span>,
              <span class="kw">Mean2</span> <span class="kw">=</span> <span class="fu">fmt_est</span>(<span class="no">.</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"mean"</span>, <span class="st">"sd"</span>)),
              <span class="kw">N3</span> <span class="kw">=</span> <span class="no">N</span>,
              <span class="kw">Mean3</span> <span class="kw">=</span> <span class="fu">fmt_est</span>(<span class="no">.</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"emmean"</span>, <span class="st">"emmean_sd"</span>)),
              <span class="kw">CI</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu">fmt_est</span>(<span class="no">.</span>, <span class="st">"emmean"</span>), <span class="fu">fmt_ci</span>(<span class="no">.</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"lower.CL"</span>, <span class="st">"upper.CL"</span>)))
      ) <span class="kw">%&gt;%</span>
      <span class="fu">select</span>(<span class="no">Trt</span>:<span class="no">CI</span>)</pre></body></html></div>
</div>
<div id="treatment-comparision" class="section level3">
<h3 class="hasAnchor">
<a href="#treatment-comparision" class="anchor"></a>Treatment Comparision</h3>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">t2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span>(<span class="no">t12</span>))

<span class="no">t2</span> <span class="kw">&lt;-</span> <span class="no">t2</span> <span class="kw">%&gt;%</span> <span class="fu">mutate</span>(
    <span class="kw">lower</span> <span class="kw">=</span> <span class="no">estimate</span> - <span class="fl">1.96</span> * <span class="no">SE</span>,
    <span class="kw">upper</span> <span class="kw">=</span> <span class="no">estimate</span> + <span class="fl">1.96</span> * <span class="no">SE</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(
    <span class="kw">comp</span> <span class="kw">=</span> <span class="st">"Study Drug vs. Placebo"</span>,
    <span class="kw">mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu">fmt_est</span>(<span class="no">.</span>, <span class="st">"estimate"</span>), <span class="fu">fmt_ci</span>(<span class="no">.</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"lower"</span>, <span class="st">"upper"</span>))),
    <span class="kw">p</span> <span class="kw">=</span> <span class="fu">fmt_pval</span>(<span class="no">.</span>, <span class="st">"p.value"</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">comp</span>:<span class="no">p</span>)</pre></body></html></div>
</div>
<div id="rmse" class="section level3">
<h3 class="hasAnchor">
<a href="#rmse" class="anchor"></a>RMSE</h3>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">t3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">rmse</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Root Mean Squared Error of Change = "</span>,
                  <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">HAMD17_lmfit</span>$<span class="no">residuals</span>), <span class="kw">digits</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">format</span> <span class="kw">=</span> <span class="st">"f"</span>, <span class="kw">flag</span> <span class="kw">=</span> <span class="st">"0"</span>)))</pre></body></html></div>
<p>The prupose of this exercise is to create a table as in <code>rtf_example1.rtf</code> by using the three datasets <code>t1</code>, <code>t2</code> and <code>t3</code></p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">t1</span></pre></body></html></div>
<pre><code>##          Trt N1       Mean1 N2       Mean2 N3       Mean3                   CI
## 1 Study Drug 61 16.6 (4.41) 61 -6.6 (5.95) 61 -7.0 (9.16)  -7.0 (-8.58, -5.38)
## 2    Placebo 70 18.4 (6.34) 70 -9.0 (7.04) 70 -8.7 (8.54) -8.7 (-10.17, -7.18)</code></pre>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">t2</span></pre></body></html></div>
<pre><code>##                     comp              mean     p
## 1 Study Drug vs. Placebo 1.7 (-0.49, 3.88) 0.130</code></pre>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">t3</span></pre></body></html></div>
<pre><code>##                                       rmse
## 1 Root Mean Squared Error of Change = 6.23</code></pre>
<p>For multiple tables like the efficacy example, we have a flow in the following to print an rtf table</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">tbl_1</span> <span class="kw">&lt;-</span> <span class="no">t1</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"ANCOVA of Change from Baseline at Week 8"</span>,
            <span class="kw">subtitle</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Missing Data Approach"</span>,
                         <span class="st">"Analysis Population"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span>(<span class="kw">colheader</span> <span class="kw">=</span> <span class="st">" | Baseline | Week 20 | Change from Baseline"</span>,
                <span class="kw">col_rel_width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">9</span>),
                <span class="kw">first_row</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span>(<span class="kw">colheader</span> <span class="kw">=</span> <span class="st">"Treatment | N | Mean (SD) | N | Mean (SD) | N | Mean (SD) | LS Mean (95% CI)\\dagger"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span>(<span class="kw">col_rel_width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span>),
           <span class="kw">text_justification</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"l"</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"c"</span>,<span class="fl">7</span>)),
           <span class="kw">last_row</span> <span class="kw">=</span> <span class="fl">FALSE</span>)  <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span>(<span class="kw">footnote</span> <span class="kw">=</span> <span class="st">"\\daggerBased on an ANCOVA model.\n ANCOVA = Analysis of Covariance, CI = Confidence Interval, LS = Least Squares, SD = Standard Deviation"</span>,
               <span class="kw">justification</span> <span class="kw">=</span> <span class="st">"l"</span>)


<span class="no">tbl_2</span> <span class="kw">&lt;-</span> <span class="no">t2</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span>(<span class="kw">colheader</span> <span class="kw">=</span> <span class="st">"Pairwise Comparison | Difference in LS Mean (95% CI)\\dagger | p-Value"</span>,
                <span class="kw">text_justification</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"l"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span>(<span class="kw">col_rel_width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">8</span>,<span class="fl">7</span>,<span class="fl">5</span>),
           <span class="kw">text_justification</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"l"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>),
           <span class="kw">last_row</span> <span class="kw">=</span> <span class="fl">FALSE</span>)


<span class="no">tbl_3</span> <span class="kw">&lt;-</span> <span class="no">t3</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span>(<span class="kw">colheader</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
           <span class="kw">col_rel_width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>),
           <span class="kw">text_justification</span> <span class="kw">=</span> <span class="st">"l"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_source.html">rtf_source</a></span>(<span class="kw">source</span> <span class="kw">=</span> <span class="st">"Source:  [study999: adam-adeff]"</span>,
             <span class="kw">justification</span> <span class="kw">=</span> <span class="st">"l"</span>)


<span class="no">tbl</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">tbl_1</span>, <span class="no">tbl_2</span>, <span class="no">tbl_3</span>)

<span class="no">tbl</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span>() <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="st">"rtf/efficacy_example.rtf"</span>)</pre></body></html></div>
</div>
</div>
<div id="example-2-a-simplified-adverse-events-summary-table" class="section level2">
<h2 class="hasAnchor">
<a href="#example-2-a-simplified-adverse-events-summary-table" class="anchor"></a>Example 2: a simplified adverse events summary table</h2>
</div>
</div>
<div id="get-raw-summary" class="section level1">
<h1 class="hasAnchor">
<a href="#get-raw-summary" class="anchor"></a>get raw summary</h1>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="co"># Step 1: Get raw summary</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">adae</span>)
<span class="no">ae_t1</span> <span class="kw">&lt;-</span> <span class="no">adae</span> <span class="kw">%&gt;%</span>
          <span class="fu">group_by</span>(<span class="no">TRTP</span>) <span class="kw">%&gt;%</span>
          <span class="fu">mutate</span>(<span class="kw">n_subj</span> <span class="kw">=</span> <span class="fu">n_distinct</span>(<span class="no">SUBJID</span>)) <span class="kw">%&gt;%</span>
          <span class="fu">group_by</span>(<span class="no">TRTP</span>, <span class="no">AEDECOD</span>) <span class="kw">%&gt;%</span>
          <span class="fu">summarise</span>(<span class="kw">n_ae</span> <span class="kw">=</span> <span class="fu">n_distinct</span>(<span class="no">SUBJID</span>),
                    <span class="kw">pct</span>  <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">n_ae</span>/<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">n_subj</span>) * <span class="fl">100</span>, <span class="fl">2</span>) ) <span class="kw">%&gt;%</span>
          <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">n_ae</span> <span class="kw">&gt;</span> <span class="fl">4</span>) <span class="kw">%&gt;%</span>  <span class="co"># only show AE terms with at least 10 subjects in one treatment group.</span>
          <span class="fu">gather</span>( <span class="kw">key</span> <span class="kw">=</span> <span class="st">"var"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="st">"value"</span>, <span class="no">n_ae</span>, <span class="no">pct</span>) <span class="kw">%&gt;%</span>
          <span class="fu">unite</span>(<span class="no">temp</span>, <span class="no">TRTP</span>, <span class="no">var</span>) <span class="kw">%&gt;%</span>
          <span class="fu">spread</span>( <span class="no">temp</span>, <span class="no">value</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="fl">0</span>)
<span class="no">ae_t1</span></pre></body></html></div>
<pre><code>## # A tibble: 21 x 7
##    AEDECOD Placebo_n_ae Placebo_pct `Xanomeline Hig… `Xanomeline Hig…
##    &lt;fct&gt;          &lt;dbl&gt;       &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1 APPLIC…            5        7.25                7             8.86
##  2 APPLIC…            0        0                  15            19.0 
##  3 APPLIC…            0        0                   9            11.4 
##  4 APPLIC…            6        8.7                22            27.8 
##  5 APPLIC…            0        0                   6             7.59
##  6 BLISTER            0        0                   0             0   
##  7 COUGH              0        0                   5             6.33
##  8 DIARRH…            9       13.0                 0             0   
##  9 DIZZIN…            0        0                  12            15.2 
## 10 ERYTHE…            9       13.0                14            17.7 
## # … with 11 more rows, and 2 more variables: `Xanomeline Low Dose_n_ae` &lt;dbl&gt;,
## #   `Xanomeline Low Dose_pct` &lt;dbl&gt;</code></pre>
</div>
<div id="write-to-an-rtf-table" class="section level1">
<h1 class="hasAnchor">
<a href="#write-to-an-rtf-table" class="anchor"></a>write to an rtf table</h1>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">ae_tbl</span> <span class="kw">&lt;-</span> <span class="no">ae_t1</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span>( <span class="st">"Analysis of Subjects With Specific Adverse Events"</span>,
             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"(Incidence &gt; 10 Subjects in One or More Treatment Groups)"</span>,
               <span class="st">"ASaT"</span>) ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span>(<span class="st">" | Placebo | Drug High Dose | Drug Low Dose"</span>,
                <span class="kw">col_rel_width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">2</span>,<span class="fl">3</span>)),
                <span class="kw">first_row</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span>(<span class="st">" | n | (%) | n | (%) | n | (%)"</span>,
                <span class="kw">border_top</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"single"</span>, <span class="fl">6</span>)),
                <span class="kw">border_left</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>,<span class="st">""</span>), <span class="fl">3</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span>(<span class="kw">col_rel_width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>,<span class="fl">6</span>)) ,
           <span class="kw">text_justification</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"l"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"c"</span>,<span class="fl">6</span>)),
           <span class="kw">border_left</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>,<span class="st">""</span>), <span class="fl">3</span>) )) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"\\daggerThis is footnote 1"</span>, <span class="st">"This is footnote 2"</span>),
               <span class="kw">justification</span> <span class="kw">=</span> <span class="st">"l"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_source.html">rtf_source</a></span>(<span class="st">"Source: xxx"</span>,
             <span class="kw">justification</span> <span class="kw">=</span> <span class="st">"l"</span>)


<span class="no">ae_tbl</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span>() <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="st">"rtf/ae_example.rtf"</span>)</pre></body></html></div>
</div>
<div id="example-3-adverse-events-example-page_by-option" class="section level1">
<h1 class="hasAnchor">
<a href="#example-3-adverse-events-example-page_by-option" class="anchor"></a>Example 3: adverse events example page_by option</h1>
</div>
<div id="write-to-an-rtf-table-1" class="section level1">
<h1 class="hasAnchor">
<a href="#write-to-an-rtf-table-1" class="anchor"></a>write to an rtf table</h1>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">ae_tbl</span> <span class="kw">&lt;-</span> <span class="no">ae_t1</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span>( <span class="st">"Analysis of Subjects With Specific Adverse Events"</span>,
             <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"(Incidence &gt; 10 Subjects in One or More Treatment Groups)"</span>,
                          <span class="st">"ASaT"</span>) ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span>(<span class="st">" | Placebo | Drug High Dose | Drug Low Dose"</span>,
                <span class="kw">col_rel_width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">2</span>,<span class="fl">3</span>)),
                <span class="kw">first_row</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span>(<span class="st">" | n | (%) | n | (%) | n | (%)"</span>,
                <span class="kw">border_top</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"single"</span>, <span class="fl">6</span>)),
                <span class="kw">border_left</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>,<span class="st">""</span>), <span class="fl">3</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span>(<span class="kw">col_rel_width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>,<span class="fl">6</span>)) ,
           <span class="kw">text_justification</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"l"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"c"</span>,<span class="fl">6</span>)),
           <span class="kw">border_left</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>,<span class="st">""</span>), <span class="fl">3</span>) ),
           <span class="kw">page_num</span> <span class="kw">=</span> <span class="fl">10</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span>(<span class="st">"This is a footnote"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_source.html">rtf_source</a></span>(<span class="st">"Source: xxx"</span>)


<span class="no">ae_tbl</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span>() <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="st">"rtf/ae_example_page_num_10.rtf"</span>)</pre></body></html></div>
</div>
<div id="example-4-group_by-feature" class="section level1">
<h1 class="hasAnchor">
<a href="#example-4-group_by-feature" class="anchor"></a>Example 4: group_by feature</h1>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">iris</span>)

<span class="no">iris</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">iris</span>, <span class="kw">new_cat</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"D"</span>,<span class="st">"E"</span>), <span class="fl">30</span>))

<span class="no">iris_tbl</span> <span class="kw">&lt;-</span> <span class="no">iris</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span>(<span class="st">"IRIS DATA"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span>(<span class="st">"Sepal Length | Sepal Width | Petal Length | PetalWidth"</span>,
                <span class="kw">first_row</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span>(
           <span class="kw">page_by</span>  <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Species"</span>, <span class="st">"new_cat"</span>),
           <span class="kw">new_page</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
           <span class="kw">page_num</span> <span class="kw">=</span> <span class="fl">30</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span>(<span class="st">"This is a footnote"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_source.html">rtf_source</a></span>(<span class="st">"Source: xxx"</span>)

<span class="no">iris_tbl</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span>() <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="st">"rtf/iris_example.rtf"</span>)</pre></body></html></div>
<div id="example-5-a-very-simple-example" class="section level2">
<h2 class="hasAnchor">
<a href="#example-5-a-very-simple-example" class="anchor"></a>Example 5: A very simple example</h2>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">iris</span>)

<span class="no">iris_tbl</span> <span class="kw">&lt;-</span> <span class="no">iris</span>[<span class="fl">1</span>:<span class="fl">20</span>,] <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span>()

<span class="no">iris_tbl</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span>() <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="st">"rtf/iris_very_simple.rtf"</span>)</pre></body></html></div>
</div>
<div id="example-6-a-simple-example" class="section level2">
<h2 class="hasAnchor">
<a href="#example-6-a-simple-example" class="anchor"></a>Example 6: A simple example</h2>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">iris</span>)

<span class="no">iris_tbl</span> <span class="kw">&lt;-</span> <span class="no">iris</span>[<span class="fl">1</span>:<span class="fl">20</span>,] <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span>(<span class="st">"IRIS DATA"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span>(<span class="st">"Sepal Length | Sepal Width | Petal Length | PetalWidth | Species"</span>,
                <span class="kw">first_row</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span>(<span class="st">"This is a footnote"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_source.html">rtf_source</a></span>(<span class="st">"Source: xxx"</span>)

<span class="no">iris_tbl</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span>() <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="st">"rtf/iris_simple.rtf"</span>)</pre></body></html></div>
</div>
<div id="example-7-baseline-characteristics-example-feature" class="section level2">
<h2 class="hasAnchor">
<a href="#example-7-baseline-characteristics-example-feature" class="anchor"></a>Example 7: baseline characteristics example feature</h2>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">bs_count</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">data</span>, <span class="no">grp</span>, <span class="no">var</span>,
                     <span class="no">var_label</span> <span class="kw">=</span> <span class="no">var</span>,
                     <span class="no">decimal</span> <span class="kw">=</span> <span class="fl">1</span>,
                     <span class="no">total</span> <span class="kw">=</span> <span class="fl">TRUE</span>){


  <span class="no">data</span> <span class="kw">&lt;-</span> <span class="no">data</span> <span class="kw">%&gt;%</span> <span class="fu">rename</span>(<span class="kw">grp</span> <span class="kw">=</span> !! <span class="no">grp</span>, <span class="kw">var</span> <span class="kw">=</span> !! <span class="no">var</span>)
  <span class="no">coding</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">data</span>$<span class="no">grp</span>) )
  <span class="no">data</span> <span class="kw">&lt;-</span> <span class="no">data</span> <span class="kw">%&gt;%</span> <span class="fu">mutate</span>(<span class="kw">grp</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">grp</span>)))

  <span class="co"># res &lt;- data %&gt;% count(grp, var, .drop = FALSE)</span>
  <span class="no">res</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">data</span>, <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">var</span>, <span class="no">grp</span>)) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>() <span class="kw">%&gt;%</span>
              <span class="fu">mutate</span>(<span class="kw">grp</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">grp</span>))

  <span class="kw">if</span>(<span class="no">total</span>){
    <span class="no">res_tot</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">data</span>, <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">var</span>)) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>() <span class="kw">%&gt;%</span> <span class="fu">mutate</span>(<span class="kw">grp</span> <span class="kw">=</span> <span class="fl">9999</span>)
    <span class="no">res</span> <span class="kw">&lt;-</span> <span class="fu">bind_rows</span>(<span class="no">res</span>, <span class="no">res_tot</span>)
  }

  <span class="no">res</span> <span class="kw">&lt;-</span> <span class="no">res</span> <span class="kw">%&gt;%</span> <span class="fu">rename</span>(<span class="kw">n</span> <span class="kw">=</span> <span class="no">Freq</span>)

  <span class="no">res</span> <span class="kw">&lt;-</span> <span class="no">res</span> <span class="kw">%&gt;%</span> <span class="fu">mutate</span>(<span class="kw">pct</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span>( <span class="no">n</span> / <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">n</span>) * <span class="fl">100</span>, <span class="kw">digits</span> <span class="kw">=</span> <span class="no">decimal</span>, <span class="kw">format</span> <span class="kw">=</span> <span class="st">"f"</span>, <span class="kw">flag</span> <span class="kw">=</span> <span class="st">"0"</span>) )

  <span class="no">res</span> <span class="kw">&lt;-</span> <span class="no">res</span> <span class="kw">%&gt;%</span> <span class="fu">gather</span>(<span class="st">"key"</span>, <span class="st">"value"</span>, <span class="no">n</span>, <span class="no">pct</span>) <span class="kw">%&gt;%</span>
                 <span class="fu">unite</span>(<span class="no">keys</span>, <span class="no">grp</span>, <span class="no">key</span>) <span class="kw">%&gt;%</span>
                 <span class="fu">spread</span>(<span class="no">keys</span>, <span class="no">value</span>) <span class="kw">%&gt;%</span>
                 <span class="fu">mutate</span>(<span class="kw">var_label</span> <span class="kw">=</span> <span class="no">var_label</span>) <span class="kw">%&gt;%</span>
                 <span class="fu">mutate</span>(<span class="kw">var</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">var</span>))

  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">res</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="st">"_n"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">res</span>), <span class="kw">fixed</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(<span class="no">res</span>, <span class="st">"coding"</span>) <span class="kw">&lt;-</span> <span class="no">coding</span>

  <span class="no">res</span>
}

<span class="no">bs_continous</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">data</span>, <span class="no">grp</span>, <span class="no">var</span>,
                         <span class="no">var_label</span> <span class="kw">=</span> <span class="no">var</span>,
                         <span class="no">decimal</span> <span class="kw">=</span> <span class="fl">1</span>,
                         <span class="no">total</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                         <span class="no">blank_row</span> <span class="kw">=</span> <span class="fl">FALSE</span>){

  <span class="no">data</span> <span class="kw">&lt;-</span> <span class="no">data</span> <span class="kw">%&gt;%</span> <span class="fu">rename</span>(<span class="kw">grp</span> <span class="kw">=</span> !! <span class="no">grp</span>, <span class="kw">var</span> <span class="kw">=</span> !! <span class="no">var</span>)
  <span class="no">coding</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">data</span>$<span class="no">grp</span>) )
  <span class="no">data</span> <span class="kw">&lt;-</span> <span class="no">data</span> <span class="kw">%&gt;%</span> <span class="fu">mutate</span>(<span class="kw">grp</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">grp</span>)))

  <span class="no">res</span> <span class="kw">&lt;-</span> <span class="no">data</span> <span class="kw">%&gt;%</span> <span class="fu">select</span>(<span class="no">grp</span>, <span class="no">var</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span>() <span class="kw">%&gt;%</span>
         <span class="fu">group_by</span>(<span class="no">grp</span>) <span class="kw">%&gt;%</span>
         <span class="fu">summarise</span>(<span class="kw">`Subjects with data`</span> <span class="kw">=</span> <span class="fu">n</span>(),
                   <span class="kw">Mean</span> <span class="kw">=</span>   <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">var</span>),   <span class="kw">digits</span> <span class="kw">=</span> <span class="no">decimal</span>, <span class="kw">format</span> <span class="kw">=</span> <span class="st">"f"</span>, <span class="kw">flag</span> <span class="kw">=</span> <span class="st">"0"</span>),
                   <span class="kw">SD</span> <span class="kw">=</span>     <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span>( <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">var</span>)  ,   <span class="kw">digits</span> <span class="kw">=</span> <span class="no">decimal</span>, <span class="kw">format</span> <span class="kw">=</span> <span class="st">"f"</span>, <span class="kw">flag</span> <span class="kw">=</span> <span class="st">"0"</span>),
                   <span class="kw">Median</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span>( <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">var</span>), <span class="kw">digits</span> <span class="kw">=</span> <span class="no">decimal</span>, <span class="kw">format</span> <span class="kw">=</span> <span class="st">"f"</span>, <span class="kw">flag</span> <span class="kw">=</span> <span class="st">"0"</span>),
                   <span class="kw">Range</span> <span class="kw">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="no">var</span>), <span class="kw">collapse</span> <span class="kw">=</span> <span class="st">" to "</span>) )

  <span class="kw">if</span>(<span class="no">total</span>){

    <span class="no">res_tot</span> <span class="kw">&lt;-</span> <span class="no">data</span> <span class="kw">%&gt;%</span> <span class="fu">select</span>(<span class="no">grp</span>, <span class="no">var</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span>() <span class="kw">%&gt;%</span>
      <span class="fu">summarise</span>(<span class="kw">`Subjects with data`</span> <span class="kw">=</span> <span class="fu">n</span>(),
                <span class="kw">Mean</span> <span class="kw">=</span>   <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">var</span>),   <span class="kw">digits</span> <span class="kw">=</span> <span class="no">decimal</span>, <span class="kw">format</span> <span class="kw">=</span> <span class="st">"f"</span>, <span class="kw">flag</span> <span class="kw">=</span> <span class="st">"0"</span>),
                <span class="kw">SD</span> <span class="kw">=</span>     <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span>( <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">var</span>)  ,   <span class="kw">digits</span> <span class="kw">=</span> <span class="no">decimal</span>, <span class="kw">format</span> <span class="kw">=</span> <span class="st">"f"</span>, <span class="kw">flag</span> <span class="kw">=</span> <span class="st">"0"</span>),
                <span class="kw">Median</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span>( <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">var</span>), <span class="kw">digits</span> <span class="kw">=</span> <span class="no">decimal</span>, <span class="kw">format</span> <span class="kw">=</span> <span class="st">"f"</span>, <span class="kw">flag</span> <span class="kw">=</span> <span class="st">"0"</span>),
                <span class="kw">Range</span> <span class="kw">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="no">var</span>), <span class="kw">collapse</span> <span class="kw">=</span> <span class="st">" to "</span>) ) <span class="kw">%&gt;%</span>
      <span class="fu">mutate</span>(<span class="kw">grp</span> <span class="kw">=</span> <span class="fl">9999</span>)
    <span class="no">res</span> <span class="kw">&lt;-</span> <span class="fu">bind_rows</span>(<span class="no">res</span>, <span class="no">res_tot</span>)
  }


  <span class="no">res</span> <span class="kw">&lt;-</span> <span class="no">res</span> <span class="kw">%&gt;%</span> <span class="fu">gather</span>(<span class="st">"key"</span>, <span class="st">"value"</span>, - <span class="no">grp</span>) <span class="kw">%&gt;%</span>
                 <span class="fu">mutate</span>(<span class="kw">key</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">key</span>, <span class="kw">levels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Subjects with data"</span>, <span class="st">"Mean"</span>, <span class="st">"SD"</span>, <span class="st">"Median"</span>, <span class="st">"Range"</span>)) ) <span class="kw">%&gt;%</span>
                 <span class="fu">spread</span>(<span class="no">grp</span>, <span class="no">value</span>) <span class="kw">%&gt;%</span>
                 <span class="fu">mutate</span>(<span class="kw">var_label</span> <span class="kw">=</span> <span class="no">var_label</span>) <span class="kw">%&gt;%</span>
                 <span class="fu">mutate</span>(<span class="kw">key</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">key</span>)) <span class="kw">%&gt;%</span>
                 <span class="fu">rename</span>(<span class="kw">var</span> <span class="kw">=</span> <span class="no">key</span>)

  <span class="kw">if</span>(<span class="no">blank_row</span>){
    <span class="no">res</span> <span class="kw">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="kw">var_label</span> <span class="kw">=</span> <span class="no">var_label</span>), <span class="no">res</span>)
  }

  <span class="no">res</span>
}

<span class="co"># The code above define two utility function for baseline characterstic tables.</span>



<span class="co"># Analaysis Set</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">adsl</span>)
<span class="no">ana</span> <span class="kw">&lt;-</span> <span class="no">adsl</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">ITT</span> <span class="kw">==</span> <span class="st">"Y"</span>)
<span class="no">ana</span> <span class="kw">&lt;-</span> <span class="no">ana</span> <span class="kw">%&gt;%</span> <span class="fu">mutate</span>(
  <span class="kw">RACE</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">RACE</span>,
                <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"African Descent (Negro, Black)"</span>, <span class="st">"Caucasian"</span>, <span class="st">"Hispanic (Mexican - American, Mexico, Central And South America)"</span>,
                  <span class="st">"Other (Mixed - Racial Heritage, American Indian, Eskimo)"</span>)),
                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Black"</span>, <span class="st">"Caucasian"</span>, <span class="st">"Hispanic"</span>, <span class="st">"Other"</span>)),
  <span class="kw">SEX</span>  <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">SEX</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"F"</span>, <span class="st">"M"</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>))
)

<span class="co"># Build Data for r2rtf</span>
<span class="no">bs_tb</span> <span class="kw">&lt;-</span> <span class="fu">bind_rows</span>(
  <span class="fu">bs_count</span>(<span class="no">ana</span>, <span class="st">"TRTPN"</span>, <span class="st">"SEX"</span>, <span class="st">"Gender"</span>),
  <span class="fu">bs_count</span>(<span class="no">ana</span>, <span class="st">"TRTPN"</span>, <span class="st">"AGEGRP"</span>, <span class="st">"Age (Years)"</span>),
  <span class="fu">bs_continous</span>(<span class="no">ana</span>, <span class="st">"TRTPN"</span>, <span class="st">"AGE"</span>, <span class="st">"Age (Years)"</span>, <span class="kw">blank_row</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
  <span class="fu">bs_count</span>(<span class="no">ana</span>, <span class="st">"TRTPN"</span>, <span class="st">"RACE"</span>, <span class="st">"Race"</span>)
)

<span class="no">bs_tb</span>[ <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">bs_tb</span>) ] <span class="kw">&lt;-</span> <span class="st">""</span></pre></body></html></div>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">bs_rtf</span> <span class="kw">&lt;-</span>  <span class="no">bs_tb</span> <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span>(<span class="st">"Demographic and Anthropometric Characteristics"</span>,<span class="st">"ITT Subjects"</span>) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span>(<span class="st">" | Placebo | Drug Low Dose | Drug High Dose | Total | label"</span>,
                <span class="kw">col_rel_width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">2</span>,<span class="fl">4</span>),<span class="fl">3</span>),
                <span class="kw">page_width</span> <span class="kw">=</span> <span class="fl">9.5</span>,
                <span class="kw">first_row</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span>(<span class="st">" | n | (%) | n | (%) | n | (%) | n | (%) | label"</span>,
                <span class="kw">page_width</span> <span class="kw">=</span> <span class="fl">9.5</span>,
                <span class="kw">border_top</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"single"</span>, <span class="fl">9</span>)),
                <span class="kw">border_left</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>,<span class="st">""</span>), <span class="fl">4</span>),<span class="st">"single"</span>)) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span>(<span class="kw">page_width</span> <span class="kw">=</span> <span class="fl">9.5</span>,
           <span class="kw">col_rel_width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.2</span>, <span class="fl">0.8</span>), <span class="fl">4</span>),<span class="fl">3</span>) ,
           <span class="kw">text_justification</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"l"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"d"</span>,<span class="fl">8</span>),<span class="st">"c"</span>),
           <span class="kw">border_left</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>,<span class="st">""</span>), <span class="fl">4</span>),<span class="st">"single"</span> )) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span>(<span class="st">"This is a footnote"</span>) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_source.html">rtf_source</a></span>(<span class="st">"Source: xxx"</span>)


<span class="co"># Output</span>

<span class="no">bs_rtf</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span>() <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="st">"rtf/bs_example.rtf"</span>)</pre></body></html></div>
</div>
<div id="example-8-baseline-characteristics-example-page_by-feature" class="section level2">
<h2 class="hasAnchor">
<a href="#example-8-baseline-characteristics-example-page_by-feature" class="anchor"></a>Example 8: baseline characteristics example page_by feature</h2>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="co">## r2rtf rtf table createion pipeline</span>
<span class="no">bs_rtf</span> <span class="kw">&lt;-</span>  <span class="no">bs_tb</span> <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span>(<span class="st">"Demographic and Anthropometric Characteristics"</span>,<span class="st">"ITT Subjects"</span>) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span>(<span class="st">" | Placebo | Drug Low Dose | Drug High Dose | Total"</span>,
                <span class="kw">col_rel_width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">2</span>,<span class="fl">4</span>)),
                <span class="kw">first_row</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span>(<span class="st">" | n | (%) | n | (%) | n | (%) | n | (%)"</span>,
                <span class="kw">border_top</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"single"</span>, <span class="fl">8</span>)),
                <span class="kw">border_left</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>,<span class="st">""</span>), <span class="fl">4</span>))) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span>(<span class="kw">page_by</span> <span class="kw">=</span> <span class="st">"var_label"</span>,   <span class="co"># this option show the label in one row.</span>
           <span class="kw">col_rel_width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.2</span>, <span class="fl">0.8</span>), <span class="fl">4</span>)) ,
           <span class="kw">text_justification</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"l"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"d"</span>,<span class="fl">8</span>)),
           <span class="kw">border_left</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>,<span class="st">""</span>), <span class="fl">4</span>) )) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span>(<span class="st">"This is a footnote"</span>) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_source.html">rtf_source</a></span>(<span class="st">"Source: xxx"</span>)


<span class="co"># Output</span>

<span class="no">bs_rtf</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span>() <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="st">"rtf/bs_pageby_example.rtf"</span>)</pre></body></html></div>
</div>
<div id="example-9-baseline-characteristics-example-page_by-and-new_page-feature" class="section level2">
<h2 class="hasAnchor">
<a href="#example-9-baseline-characteristics-example-page_by-and-new_page-feature" class="anchor"></a>Example 9: baseline characteristics example page_by and new_page feature</h2>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="co">## r2rtf rtf table createion pipeline</span>
<span class="no">bs_rtf</span> <span class="kw">&lt;-</span>  <span class="no">bs_tb</span> <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span>(<span class="st">"Demographic and Anthropometric Characteristics"</span>,<span class="st">"ITT Subjects"</span>) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span>(<span class="st">" | Placebo | Drug Low Dose | Drug High Dose | Total"</span>,
                <span class="kw">col_rel_width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">2</span>,<span class="fl">4</span>)),
                <span class="kw">first_row</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span>(<span class="st">" | n | (%) | n | (%) | n | (%) | n | (%)"</span>,
                <span class="kw">border_top</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"single"</span>, <span class="fl">8</span>)),
                <span class="kw">border_left</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>,<span class="st">""</span>), <span class="fl">4</span>))) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span>(<span class="kw">page_by</span> <span class="kw">=</span> <span class="st">"var_label"</span>,   <span class="co"># this option show the label in one row.</span>
           <span class="kw">new_page</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
           <span class="kw">col_rel_width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.2</span>, <span class="fl">0.8</span>), <span class="fl">4</span>)) ,
           <span class="kw">text_justification</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"l"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"d"</span>,<span class="fl">8</span>)),
           <span class="kw">border_left</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"single"</span>,<span class="st">""</span>), <span class="fl">4</span>) )) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span>(<span class="st">"This is a footnote"</span>,
               <span class="kw">justification</span> <span class="kw">=</span> <span class="st">"l"</span>) <span class="kw">%&gt;%</span>

  <span class="fu"><a href="../reference/rtf_source.html">rtf_source</a></span>(<span class="st">"Source: xxx"</span>,
             <span class="kw">justification</span> <span class="kw">=</span> <span class="st">"l"</span>)


<span class="co"># Output</span>

<span class="no">bs_rtf</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span>() <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span>(<span class="st">"rtf/bs_pageby_newpage_example.rtf"</span>)</pre></body></html></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Yilong Zhang, Siruo Wang, Simiao Ye.  </p>
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

<div class="logo">
    <p> Copyright© 2020 Merck Sharp &amp; Dohme Corp. a subsidiary of Merck &amp; Co., Inc., Kenilworth, NJ, USA. </p>
</div>

      </footer>
</div>

  


  </body>
</html>
