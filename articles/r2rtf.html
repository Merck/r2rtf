<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to r2rtf • r2rtf</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Introduction to r2rtf">
<meta name="description" content="Start here if this is your first time using r2rtf. You'll learn the basic philosophy, the most important rtf table generation verbs.">
<meta property="og:description" content="Start here if this is your first time using r2rtf. You'll learn the basic philosophy, the most important rtf table generation verbs.">
<meta property="og:image" content="https://merck.github.io/r2rtf/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">r2rtf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fas fa-file-code"></span> Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/r2rtf.html"><span class="fa fas fa-play-circle"></span> Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html"><span class="fa fas fa-book"></span> Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fas fa-newspaper"></span> Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Merck/r2rtf"><span class="fa fab fa-github"></span> Source code</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to r2rtf</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Merck/r2rtf/blob/master/vignettes/r2rtf.Rmd" class="external-link"><code>vignettes/r2rtf.Rmd</code></a></small>
      <div class="d-none name"><code>r2rtf.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><code>r2rtf</code> is an R package to create production ready tables
and figures in RTF format. The R package is designed to</p>
<ul>
<li>provide simple “verb” functions that correspond to each component of
a table, to help you translate data frame to table in RTF file.</li>
<li>enable pipes (<code>%&gt;%</code>).</li>
<li>only focus on <strong>table format</strong>. Data manipulation and
analysis should be handled by other R packages. (e.g.,
<code>tidyverse</code>)</li>
<li>
<code>r2rtf</code> minimizes package dependency</li>
</ul>
<p>Before creating an RTF table we need to:</p>
<ul>
<li>Figure out table layout.</li>
<li>Split the layout into small tasks in the form of a computer
program.</li>
<li>Execute the program.</li>
</ul>
<p>This document introduces <code>r2rtf</code> basic set of tools, and
show how to transfer data frames into Table, Listing, and Figure
(TLFs).</p>
<p>Other extended examples and features are covered in different
document listed in <a href="https://merck.github.io/r2rtf/articles/index.html">vignettes</a>.</p>
</div>
<div class="section level2">
<h2 id="data-adverse-events">Data: Adverse Events<a class="anchor" aria-label="anchor" href="#data-adverse-events"></a>
</h2>
<p>To explore the basic RTF generation verbs in <code>r2rtf</code>, we
will use the dataset <code>r2rtf_adae</code>. This dataset contain
adverse events (AE) information from a clinical trial.</p>
<p>Below is the meaning of relevant variables. More information can be
found in help page of the dataset (<code><a href="../reference/r2rtf_adae.html">?r2rtf_adae</a></code>)</p>
<ul>
<li>USUBJID: Unique Subject Identifier</li>
<li>TRTA: Actual Treatment</li>
<li>AEDECOD: Dictionary-Derived Term</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://merck.github.io/r2rtf/">r2rtf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r2rtf_adae</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">TRTA</span>, <span class="va">AEDECOD</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">##       USUBJID    TRTA                   AEDECOD</span></span>
<span><span class="co">## 1 01-701-1015 Placebo APPLICATION SITE ERYTHEMA</span></span>
<span><span class="co">## 2 01-701-1015 Placebo APPLICATION SITE PRURITUS</span></span>
<span><span class="co">## 3 01-701-1015 Placebo                 DIARRHOEA</span></span>
<span><span class="co">## 4 01-701-1023 Placebo                  ERYTHEMA</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="table-ready-data">Table ready data<a class="anchor" aria-label="anchor" href="#table-ready-data"></a>
</h2>
<p><code>dplyr</code> and <code>tidyr</code> packages are used for data
manipulation to create a data frame that contains all the information we
want to add in an RTF table.</p>
<blockquote>
<p>Please note other packages can also be used for the same purpose.</p>
</blockquote>
<p>In this AE example, we provide number of subjects with each type of
AE by treatment group.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="va">r2rtf_adae</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">TRTA</span>, <span class="va">AEDECOD</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">TRTA</span>, values_from <span class="op">=</span> <span class="va">n</span>, values_fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">##   AEDECOD        Placebo `Xanomeline High Dose` `Xanomeline Low Dose`</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> ABDOMINAL PAIN       1                      2                     3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> AGITATION            2                      1                     2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> ALOPECIA             1                      0                     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> ANXIETY              2                      0                     4</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="single-table-verbs">Single table verbs<a class="anchor" aria-label="anchor" href="#single-table-verbs"></a>
</h2>
<p><code>r2rtf</code> aims to provide one function for each type of
table layout. Commonly used verbs includes:</p>
<ul>
<li>
<code>rtf_page</code>: RTF page information</li>
<li>
<code>rtf_title</code>: RTF title information</li>
<li>
<code>rtf_colheader</code>: RTF column header information</li>
<li>
<code>rtf_body</code>: RTF table body information</li>
<li>
<code>rtf_footnote</code>: RTF footnote information</li>
<li>
<code>rtf_source</code>: RTF data source information</li>
</ul>
<p>All these verbs are designed to enables usage of pipes
(<code>%&gt;%</code>). A full list of all functions can be found in the
<a href="https://merck.github.io/r2rtf/reference/index.html">package
reference</a>.</p>
</div>
<div class="section level2">
<h2 id="simple-example">Simple Example<a class="anchor" aria-label="anchor" href="#simple-example"></a>
</h2>
<p>A minimal example below illustrates how to combine verbs using pipes
to create an RTF table.</p>
<ul>
<li>
<code><a href="../reference/rtf_body.html">rtf_body()</a></code> defines table body layout.</li>
<li>
<code><a href="../reference/rtf_encode.html">rtf_encode()</a></code> transfers table layout information into
RTF syntax.</li>
<li>
<code><a href="../reference/write_rtf.html">write_rtf()</a></code> saves RTF encoding into a file with file
extension <code>.rtf</code>.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Step 1 Add table  attributes</span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Step 2 Convert attributes to RTF encode</span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae1.rtf"</span><span class="op">)</span> <span class="co"># Step 3 Write to a .rtf file</span></span></code></pre></div>
<embed src="pdf/intro-ae1.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div class="section level2">
<h2 id="column-width">Column Width<a class="anchor" aria-label="anchor" href="#column-width"></a>
</h2>
<p>If we want to adjust the width of each column to provide more space
to the first column, this can be achieved by updating
<code>col_rel_width</code> in <code>rtf_body</code>.</p>
<p>The input of <code>col_rel_width</code> is a vector with same length
for number of columns. This argument defines the relative length of each
column within a pre-defined total column width.</p>
<p>In this example, the defined relative width is 3:2:2:2. Only the
ratio of <code>col_rel_width</code> is used. Therefore it is equivalent
to use <code>col_rel_width = c(6,4,4,4)</code> or
<code>col_rel_width = c(1.5,1,1,1)</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># define relative width</span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae2.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae2.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed><p>Note:</p>
<ul>
<li>The <code>col_rel_width</code> in the <code><a href="../reference/rtf_body.html">rtf_body()</a></code>
function only control relative width of table body. Therefore the column
header is not aligned as expected. More details will be provided in next
example to take care of column header width.</li>
<li>The total column width is defined in the <code>col_width</code>
argument of the <code><a href="../reference/rtf_page.html">rtf_page()</a></code> function.</li>
</ul>
</div>
<div class="section level2">
<h2 id="column-headers">Column Headers<a class="anchor" aria-label="anchor" href="#column-headers"></a>
</h2>
<p>In the previous example, we found an issue of misaligned column
header. We can fix the issue by using the <code><a href="../reference/rtf_colheader.html">rtf_colheader()</a></code>
function.</p>
<p>In <code>rtf_colheader</code>, <code>colheader</code> argument is
used to provide content of column header. We used <code>"|"</code> to
separate the columns.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span></span>
<span>    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,</span>
<span>    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae3.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae3.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed><p>We also allow column headers be displayed in multiple lines. If an
empty column name is needed for a column, you can insert a space between
two vertical lines; e.g., <code>"name 1 | | name 3"</code>.</p>
<p>The <code>col_rel_width</code> can be used to align column header
with different number of columns.</p>
<p>By using <code>rtf_colheader</code> with <code>col_rel_width</code>,
one can customize complicated column headers. If there are multiple
pages, column header will repeat at each page by default.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl</span>, <span class="fl">50</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span></span>
<span>    colheader <span class="op">=</span> <span class="st">" | Treatment"</span>,</span>
<span>    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span></span>
<span>    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,</span>
<span>    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae4.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae4.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div class="section level2">
<h2 id="text-alignment">Text Alignment<a class="anchor" aria-label="anchor" href="#text-alignment"></a>
</h2>
<p>In <code>rtf_*()</code> functions such as <code><a href="../reference/rtf_body.html">rtf_body()</a></code>,
<code><a href="../reference/rtf_footnote.html">rtf_footnote()</a></code>, the <code>text_justification</code>
argument is used to align text. Default is <code>"c"</code> for center
justification. To vary text justification by column, use character
vector with length of vector equal to number of columns displayed (e.g.,
<code>c("c","l","r")</code>).</p>
<p>All possible inputs can be found in the first column of
<code>r2rtf:::justification()</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">r2rtf</span><span class="fu">:::</span><span class="fu">justification</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">##   type      name rtf_code_text rtf_code_row</span></span>
<span><span class="co">## 1    l      left          \\ql       \\trql</span></span>
<span><span class="co">## 2    c    center          \\qc       \\trqc</span></span>
<span><span class="co">## 3    r     right          \\qr       \\trqr</span></span>
<span><span class="co">## 4    d   decimal          \\qj             </span></span>
<span><span class="co">## 5    j justified          \\qj</span></span></code></pre></div>
<p>Below is an example that makes the first column left-aligned and
center-aligned for the rest.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>text_justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae5.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae5.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div class="section level2">
<h2 id="text-style">Text Style<a class="anchor" aria-label="anchor" href="#text-style"></a>
</h2>
<p>In <code>rtf_*()</code> functions such as <code><a href="../reference/rtf_body.html">rtf_body()</a></code>,
<code><a href="../reference/rtf_footnote.html">rtf_footnote()</a></code>, etc., the <code>text_format</code> argument
is used for controlling text style. Default is <code>NULL</code> for
normal.</p>
<p>All possible inputs and corresponding text style can be found in
<code>r2rtf:::font_format()</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">r2rtf</span><span class="fu">:::</span><span class="fu">font_format</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">##   type        name rtf_code</span></span>
<span><span class="co">## 1           normal         </span></span>
<span><span class="co">## 2    b        bold      \\b</span></span>
<span><span class="co">## 3    i     italics      \\i</span></span>
<span><span class="co">## 4    u   underline     \\ul</span></span>
<span><span class="co">## 5    s      strike \\strike</span></span>
<span><span class="co">## 6    ^ superscript  \\super</span></span>
<span><span class="co">## 7    _   subscript    \\sub</span></span></code></pre></div>
<p>Combination of format type are permitted as input (e.g.,
<code>"ub"</code> for bold and underlined text). To vary text format by
column, use character vector with length of vector equal to number of
columns displayed (e.g., <code>c("i", "u", "ib")</code>).</p>
<p>Below is an example to make first column in bold and normal for the
rest.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>text_format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae6.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae6.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div class="section level2">
<h2 id="table-border">Table Border<a class="anchor" aria-label="anchor" href="#table-border"></a>
</h2>
<p>In <code>rtf_*()</code> functions such as <code><a href="../reference/rtf_body.html">rtf_body()</a></code>,
<code><a href="../reference/rtf_footnote.html">rtf_footnote()</a></code>, etc., <code>border_left</code>,
<code>border_right</code>, <code>border_top</code>, and
<code>border_bottom</code> control the border.</p>
<p>In example of <code>intro-ae4.rtf</code>, if we want to remove the
top border of <code>"Adverse Events"</code> in header, we can change
default value <code>"single"</code> to <code>""</code> in
<code>border_top</code> argument as shown below.</p>
<p>All possible border type inputs can be found in
<code>r2rtf:::border_type()</code>. There are 26 different border types
and we only display the first six here.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">r2rtf</span><span class="fu">:::</span><span class="fu">border_type</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##         name     rtf_code</span></span>
<span><span class="co">## 1                        </span></span>
<span><span class="co">## 2     single      \\brdrs</span></span>
<span><span class="co">## 3     double     \\brdrdb</span></span>
<span><span class="co">## 4        dot    \\brdrdot</span></span>
<span><span class="co">## 5       dash   \\brdrdash</span></span>
<span><span class="co">## 6 small dash \\brdrdashsm</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span></span>
<span>    colheader <span class="op">=</span> <span class="st">" | Treatment"</span>,</span>
<span>    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span></span>
<span>    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,</span>
<span>    border_top <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"single"</span>, <span class="st">"single"</span>, <span class="st">"single"</span><span class="op">)</span>,</span>
<span>    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae7.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae7.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div class="section level2">
<h2 id="title">Title<a class="anchor" aria-label="anchor" href="#title"></a>
</h2>
<p>The title(s) can be added using the <code><a href="../reference/rtf_title.html">rtf_title()</a></code> function
as showed in below example. To get guidance on how to change title text
style, aligning title, and other features in the
<code><a href="../reference/rtf_title.html">rtf_title()</a></code> function, help page
<code>?r2rtf::rtf_title()</code> is a good resource.</p>
<p>We can provide a vector for the <code>title</code> argument. Each
value is a separate line. The format can also be controlled by providing
a vector input in <code>text_format</code>.</p>
<blockquote>
<p>We used soft return to break lines in title.</p>
</blockquote>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Adverse Event Count by Treatment Group"</span>,</span>
<span>      <span class="st">"(An example)"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    text_format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span></span>
<span>    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,</span>
<span>    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae8.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae8.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div class="section level2">
<h2 id="footnote">Footnote<a class="anchor" aria-label="anchor" href="#footnote"></a>
</h2>
<p>The footnote(s) can be added using <code>footnote</code> argument in
the <code><a href="../reference/rtf_footnote.html">rtf_footnote()</a></code> function as showed in below example.</p>
<p>We can provide a vector for the <code>footnote</code> argument. Each
value is a separate line.</p>
<p>Below example showed the case when using <code>as_table = TRUE</code>
(default) to display footnote inside the table body.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Adverse Event Count by Treatment Group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span></span>
<span>    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,</span>
<span>    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span><span class="op">(</span></span>
<span>    footnote <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Adverse events are coded according to MedDRA version 23.0"</span>,</span>
<span>      <span class="st">"adam-adae"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    as_table <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae9.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae9.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed><p>Below example showed the case when using
<code>as_table = FALSE</code> to display footnote outside the table
body.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Adverse Event Count by Treatment Group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span></span>
<span>    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,</span>
<span>    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span><span class="op">(</span></span>
<span>    footnote <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Adverse events are coded according to MedDRA version 23.0"</span>,</span>
<span>      <span class="st">"adam-adae"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    as_table <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae10.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae10.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div class="section level2">
<h2 id="data-source">Data Source<a class="anchor" aria-label="anchor" href="#data-source"></a>
</h2>
<p>Data source can be added using <code>source</code> argument in the
<code><a href="../reference/rtf_source.html">rtf_source()</a></code> function as showed in below example.</p>
<p>Below example showed the case when using
<code>as_table = FALSE</code> (default) to display data source outside
the table body.</p>
<blockquote>
<p>We can also adjust data source to be left aligned. By default the
alignment matches the table border.</p>
</blockquote>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_page.html">rtf_page</a></span><span class="op">(</span>col_width <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># set total column width</span></span>
<span>  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Adverse Event Count by Treatment Group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span></span>
<span>    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,</span>
<span>    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_source.html">rtf_source</a></span><span class="op">(</span></span>
<span>    source <span class="op">=</span> <span class="st">"[datasource: adam-adae]"</span>,</span>
<span>    text_justification <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>    as_table <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae11.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae11.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed><p>Below example showed the case when using <code>as_table = TRUE</code>
to display data source inside the table body.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Adverse Event Count by Treatment Group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span></span>
<span>    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,</span>
<span>    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_source.html">rtf_source</a></span><span class="op">(</span></span>
<span>    source <span class="op">=</span> <span class="st">"[datasource: adam-adae]"</span>,</span>
<span>    as_table <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae12.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae12.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div class="section level2">
<h2 id="special-character">Special Character<a class="anchor" aria-label="anchor" href="#special-character"></a>
</h2>
<p>In the <code>r2rtf</code> package, <code>'^'</code> is a character to
be converted to rtf code <code>'\\super'</code> to generate superscript;
<code>'_'</code> is for subscript.</p>
<p>Similarly, <code>'&lt;='</code> is a <code>r2rtf</code> package
specified character to be converted to LaTeX command
<code>'\\leq'</code> to generate special character
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≤</mo><annotation encoding="application/x-tex">\leq</annotation></semantics></math>.</p>
<p>LaTeX commands can be used for Greek letters and math symbol such as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>∞</mi><annotation encoding="application/x-tex">\infty</annotation></semantics></math>.
You will need to use double backslash <code>\\</code> to escape
backslash in R. i.e. <code>"\\alpha"</code>, <code>"\\pm"</code> and
<code>"\\infty"</code>. A list of LaTeX commands can be found <a href="https://www.overleaf.com/learn/latex/List_of_Greek_letters_and_math_symbols" class="external-link">here</a>.</p>
<p>Example below demonstrates this idea.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Adverse Event Count by Treatment Group{^a}"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span></span>
<span>    colheader <span class="op">=</span> <span class="st">"Adverse Events{\\super 1} | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,</span>
<span>    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span><span class="op">(</span></span>
<span>    footnote <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"{\\super 1}Adverse events are coded according to MedDRA 20.0{&lt;=}version {\\leq}23.0"</span>,</span>
<span>      <span class="st">"\\alpha + \\gamma &lt;= \\infty"</span>,</span>
<span>      <span class="st">"{^a}adam-adae"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    as_table <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae13.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae13.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div class="section level2">
<h2 id="table-color">Table Color<a class="anchor" aria-label="anchor" href="#table-color"></a>
</h2>
<p>Each cell’s text and background color are adjustable. Take
<code>intro-ae13.rtf</code> as an example. If we want to add gray
background color to cells with 0 AE, we need to create a color name
matrix corresponding to each cell in table body.</p>
<p>Then we need to assign this background color matrix to
<code>text_background_color</code> argument in the
<code><a href="../reference/rtf_body.html">rtf_body()</a></code> function as shown below.</p>
<p>Note:</p>
<ul>
<li>When creating a color name matrix, each element needs to be a color
name defined in <code><a href="https://rdrr.io/r/grDevices/colors.html" class="external-link">grDevices::colours()</a></code>.</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span></span>
<span><span class="va">color_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/trimws.html" class="external-link">trimws</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">tbl1</span>, <span class="fl">2</span>, <span class="va">as.character</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="st">"0"</span>, <span class="st">"gray"</span>, <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="va">color_matrix</span></span>
<span><span class="co">##      AEDECOD Placebo Xanomeline High Dose Xanomeline Low Dose</span></span>
<span><span class="co">## [1,] "white" "white" "white"              "white"            </span></span>
<span><span class="co">## [2,] "white" "white" "white"              "white"            </span></span>
<span><span class="co">## [3,] "white" "white" "gray"               "gray"             </span></span>
<span><span class="co">## [4,] "white" "white" "gray"               "white"            </span></span>
<span><span class="co">## [5,] "white" "white" "white"              "white"            </span></span>
<span><span class="co">## [6,] "white" "white" "white"              "white"</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Adverse Event Count by Treatment Group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span></span>
<span>    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,</span>
<span>    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span></span>
<span>    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    text_background_color <span class="op">=</span> <span class="va">color_matrix</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae14.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae14.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div class="section level2">
<h2 id="page-setup">Page setup<a class="anchor" aria-label="anchor" href="#page-setup"></a>
</h2>
<p>The total number of rows in each page can be controlled in
<code>nrow</code> argument of <code><a href="../reference/rtf_page.html">rtf_page()</a></code> function. Every
lines is counted including title, subline, header, body, footnote,
source, and extra rows.</p>
<p>The value in <code>nrow</code> is the maximum number of rows allowed
in one page, the actual rows display can be slightly smaller.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_page.html">rtf_page</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">40</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Adverse Events Example"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span></span>
<span>    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,</span>
<span>    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span></span>
<span>    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    text_justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae15.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae15.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div class="section level2">
<h2 id="subline_by-feature">subline_by feature<a class="anchor" aria-label="anchor" href="#subline_by-feature"></a>
</h2>
<p>Users can use the <code>subline_by</code> argument in the
<code><a href="../reference/rtf_body.html">rtf_body()</a></code> function to group table by assigning the
<code>subline_by</code> variable.</p>
<p>A subject line will be displayed at the beginning of each page based
on the variable provided to <code>subline_by</code>. Different values of
<code>subline_by</code> will be broken into different pages.</p>
<p>Below example shows using treatment group as the
<code>subline_by</code> variable.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aegt5</span> <span class="op">&lt;-</span> <span class="va">r2rtf_adae</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">TRTA</span>, <span class="va">AEDECOD</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>Count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">USUBJID</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Count</span> <span class="op">&gt;</span> <span class="fl">7</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">TRTA</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">Count</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">aegt5</span><span class="op">)</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">##   TRTA                 AEDECOD                   Count</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Placebo              DIARRHOEA                     9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Placebo              ERYTHEMA                      9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Placebo              PRURITUS                      8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Xanomeline High Dose PRURITUS                     26</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Xanomeline High Dose APPLICATION SITE PRURITUS    22</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> Xanomeline High Dose APPLICATION SITE ERYTHEMA    15</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aegt5</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Top Adverse Events by Treatment Group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>colheader <span class="op">=</span> <span class="st">"Adverse Events|Count"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>subline_by <span class="op">=</span> <span class="st">"TRTA"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae16.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae16.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div class="section level2">
<h2 id="page_by-feature">page_by feature<a class="anchor" aria-label="anchor" href="#page_by-feature"></a>
</h2>
<p>Users can use <code>page_by</code> argument in the
<code><a href="../reference/rtf_body.html">rtf_body()</a></code> function to group/separate table by single cell
row with assigned <code>page_by</code> variable’s value in it.</p>
<p>A row header will be generated at the beginning of each
<code>page_by</code> group.</p>
<p>If <code>new_page = TRUE</code>, different values of
<code>group_by</code> will be broken into different pages. Default is
<code>FALSE</code>.</p>
<p>Below example showed using treatment group as <code>page_by</code>
variable.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aegt5</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Top Adverse Events by Treatment Group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>colheader <span class="op">=</span> <span class="st">"Adverse Events|Count"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span></span>
<span>    page_by <span class="op">=</span> <span class="st">"TRTA"</span>,</span>
<span>    new_page <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae17.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae17.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div class="section level2">
<h2 id="group_by-feature">group_by feature<a class="anchor" aria-label="anchor" href="#group_by-feature"></a>
</h2>
<p>Users can use the <code>group_by</code> argument in the
<code><a href="../reference/rtf_body.html">rtf_body()</a></code> function to display once for group variable.</p>
<p>Below example shows using treatment group as <code>group_by</code>
variable.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aegt5</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Top Adverse Events by Treatment Group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>colheader <span class="op">=</span> <span class="st">"Treatment|Adverse Events|Count"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span></span>
<span>    group_by <span class="op">=</span> <span class="st">"TRTA"</span>,</span>
<span>    text_justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"c"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae18.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae18.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div class="section level2">
<h2 id="figure">Figure<a class="anchor" aria-label="anchor" href="#figure"></a>
</h2>
<p>The last example showed how to insert a figure into a RTF
document.</p>
<p>The workflow can be summarized as:</p>
<ul>
<li>Save figures into PNG format. (e.g. using <code><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png()</a></code> or
<code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggplot2::ggsave()</a></code>).</li>
<li>Read PNG files into R as binary file using
<code><a href="../reference/rtf_read_figure.html">rtf_read_figure()</a></code>.</li>
<li>Add optional features using <code><a href="../reference/rtf_title.html">rtf_title()</a></code>,
<code><a href="../reference/rtf_footnote.html">rtf_footnote()</a></code>, <code><a href="../reference/rtf_source.html">rtf_source()</a></code>.</li>
<li>Set up page and figure options using <code><a href="../reference/rtf_figure.html">rtf_figure()</a></code>.</li>
<li>Convert to rtf encoding using
<code>rtf_encode(doc_type = "figure")</code>. (Note: it is important to
set <code>doc_type = "figure"</code> as the default is
<code>doc_type = "table</code> to set up tables).</li>
<li>Write rtf to a file using <code><a href="../reference/write_rtf.html">write_rtf()</a></code>.</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pruritus</span> <span class="op">&lt;-</span> <span class="va">r2rtf_adae</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">AEDECOD</span> <span class="op">==</span> <span class="st">"PRURITUS"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">TRTA</span>, <span class="va">AEDECOD</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>Count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">USUBJID</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pruritus</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TRTA</span>, y <span class="op">=</span> <span class="va">Count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig</span></span></code></pre></div>
<p><img src="r2rtf_files/figure-html/unnamed-chunk-45-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filename</span> <span class="op">&lt;-</span> <span class="st">"fig/intro-fig1.png"</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="va">filename</span>, <span class="va">fig</span><span class="op">)</span></span>
<span><span class="co">## Saving 7.29 x 4.51 in image</span></span>
<span></span>
<span><span class="va">filename</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_read_figure.html">rtf_read_figure</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span><span class="st">"Pruritus Frequency by Treatment Group"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span><span class="op">(</span><span class="st">"footnote here"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_source.html">rtf_source</a></span><span class="op">(</span><span class="st">"[datasource: adam-adae]"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_figure.html">rtf_figure</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span>doc_type <span class="op">=</span> <span class="st">"figure"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae19.rtf"</span><span class="op">)</span></span></code></pre></div>
<embed src="pdf/intro-ae19.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yilong Zhang, Siruo Wang, Simiao Ye, Fansen Kong, Brian Lang, Benjamin Wang. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1. <br>Copyright © 2023 Merck &amp; Co., Inc., Rahway, NJ, USA and its affiliates. All rights reserved.</p>
</div>

<div class="pkgdown-footer-right">
  <p><span></span></p>
</div>

    </footer>
</div>





  </body>
</html>
